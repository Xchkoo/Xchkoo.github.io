
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>[题解]洛谷-P3384 模板题重链剖分-线段树 - Xchkoo&#39;s blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Xchkoo,Xchkoo.top,blog,"> 
    <meta name="description" content="Xchkoo,讲解视频大约一个小时，需要加载半分钟左右。


原题和值得参考的博客
p3384
oi-wiki 树链剖分
oi-wiki 线段树
参考 树链剖分详解
参考 洛谷优秀题解

代码代码有详细的注释，不,"> 
    <meta name="author" content="Xchkoo"> 
    <link rel="alternative" href="atom.xml" title="Xchkoo&#39;s blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/X.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Xchkoo&#39;s blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://xchkoo.github.io"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">[题解]洛谷-P3384 模板题重链剖分-线段树</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">[题解]洛谷-P3384 模板题重链剖分-线段树</h1>
        <div class="stuff">
            <span>四月 05, 2021</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/hld/" rel="tag">hld</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/luogu-P3384-%E6%A8%A1%E6%9D%BF%E9%A2%98/" rel="tag">luogu-P3384 模板题</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E6%87%92%E6%A0%87%E8%AE%B0/" rel="tag">懒标记</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" rel="tag">线段树</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E9%87%8D%E9%93%BE%E5%89%96%E5%88%86/" rel="tag">重链剖分</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">题解</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="讲解"><a href="#讲解" class="headerlink" title="讲解"></a>讲解</h1><p>视频大约一个小时，需要加载半分钟左右。</p>
<iframe src="//player.bilibili.com/player.html?aid=459949113&cid=319890611&page=1&danmaku=0" allowfullscreen="allowfullscreen" width="100%" height="500" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>

<h1 id="原题和值得参考的博客"><a href="#原题和值得参考的博客" class="headerlink" title="原题和值得参考的博客"></a>原题和值得参考的博客</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3384">p3384</a></li>
<li><a target="_blank" rel="noopener" href="https://oi-wiki.org/graph/hld/">oi-wiki 树链剖分</a></li>
<li><a target="_blank" rel="noopener" href="https://oi-wiki.org/ds/seg/">oi-wiki 线段树</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chinhhh/p/7965433.html">参考 树链剖分详解</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/zengqinyi/solution-p3384">参考 洛谷优秀题解</a></li>
</ul>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>代码有详细的注释，不理解可以看视频。</p>
<pre><code class="cpp">/*
 * © Copyright 2021 Xchkoo All rights reserved.
 *
 * AUTHOR: Xchkoo
 * DATE: 2021-04-02
 * LISENSE: CC v4.0 BY-SA https://creativecommons.org/licenses/by-sa/4.0/deed.zh
 * Welcome to my blog -&gt; https://Xchkoo.top/
 */
#include&lt;iostream&gt;
#include&lt;string&gt;
#include&lt;algorithm&gt;
#include&lt;cstring&gt;/*这个cstring里有个memset是不得不用啊*/

#define mid ((l+r)&gt;&gt;1)
#define lson rt&lt;&lt;1,l,mid
#define rson rt&lt;&lt;1|1,mid+1,r
#define len (r-l+1)
/* 这段主要是为了线段树，手敲太麻烦了 */
typedef long long ll;
typedef size_t s_t;
#define mem(a,b) memset(a,(b),sizeof(a))
using namespace std;


/* START global variate block */

const int MAXN = 100000+10;
int n, m, r, mod,cnt=1,dfs2_cnt,res=0;
int head[MAXN],segment_tree[MAXN&lt;&lt;1],value[MAXN],wt[MAXN],lazy[MAXN&lt;&lt;1],depth[MAXN],father[MAXN],node_size[MAXN],heavy_son[MAXN],array_top[MAXN],id[MAXN];

/* END global variate block */


/* START function and class block */

/* START tree part */

struct Node &#123;
    int next, to;
&#125; e[MAXN&lt;&lt;1];

void add_edge(int u, int v) &#123;
    e[cnt].next = head[u];
    e[cnt].to = v;
    head[u] = cnt; 
    cnt++;
&#125;

/* END */

/* START segment tree part */
/* 实际上我们把线段树函数单独拎出来，将线段树通过一个范围参数传入 */
void pushdown(int rt,int size)
/* 
 * 这块是懒标记,相比起lowbit这个其实好理解一点。
 * 懒标记意味着它不会主动更新，它把这个操作储存到结点的lazy属性中（在c++中我们通过使用lazy数组来实现），
 * 当有用到这个结点和这个结点的子树时（比如查询的dfs滚到这里了），我们会将懒标记打破，分配到每个它的子树，
 * 当这个懒标记滚到叶子结点的时候，懒标记就转换成值加入叶子结点的值属性。
 * ————————————————————————————————————————————————————————————————————
 * 回到题目可能能更好理解一点，题目的操作3是要给指定的范围加值（1、2要用到hld我们先放着），
 * 比方现在的范围是3-8，我们有一条1-10的线段并且我们在这个线段上建立了一棵线段树。
 * 于是我们给3、8的lca（最近公共祖先）加个懒标记。
 * 现在有个操作要查询3-4的数据，可以，我们于是从root开始向3-4出发
 * 在这个时候我们发现root有一个懒标记属性，遵从定义我们把它打碎，分配给子结点
 * （注意：我们是在把3-8共同加一个值吧！注意“共同”！）。
 * 现在我们查找3-4时就会以这个顺序
 *                             1-10-&gt;|1-5  -&gt;|1-3  -&gt;|1-2-...
 *                           |       |        |2-3 -&gt;| 2  HERE        
 *                           |       |               | 3
 *                           |       |3-5  -&gt;|3-4  HERE
 *                           |5-10 -...      |4-5-...
 * 在同时我们会顺便把懒标记推下去，最终推到2 和 3-4 
 * 这里要一个转化：我们是在把3-8共同加一个值，共同意味着3-4这个区间其实要3加一次4加一次，
 * 总共要加两次。所以在求和时要乘上子结点个数。
 * 理解了的话就看代码吧：
 */
&#123;
    /* 左右子节点都加上父节点的lazy属性 */
    lazy[rt&lt;&lt;1]+=lazy[rt];
    lazy[rt&lt;&lt;1|1]+=lazy[rt];
    
    /* 这里是左右结点把lazy打破的过程 
     * 注意：segment_tree是一个线段树结点的值的集合，
     * 不是叶子结点的结点的值 是其子树所有结点的值的和。
     * 所以在传递懒标记的过程中我们应当把这个结点的值也更新了。
     */
    segment_tree[rt&lt;&lt;1]+=lazy[rt]*(size-(size&gt;&gt;1));
    segment_tree[rt&lt;&lt;1|1]+=lazy[rt]*(size&gt;&gt;1);
    segment_tree[rt&lt;&lt;1]%=mod;
    segment_tree[rt&lt;&lt;1|1]%=mod;
    lazy[rt]=0;
&#125;

void build(int rt,int l,int r)
/*
 * 此函数是在建立一棵线段树，
 * 因为我们在处理操作3、4时并不需要树链剖分，
 * 直接在原来树的基础上就可以了。
 */
&#123;
    if(l == r)
    /*
     * 当左範圍等于右範圍，
     * 它的范围就是一，也就是一个叶子结点，
     * 这个条件意味着可以结束递归了。
     */
    &#123;
        segment_tree[rt] = wt[l];
        if(segment_tree[rt]&gt;mod) segment_tree[rt]%=mod;
        /*
         * 别忘了题目有取模的操作。
         * 另外取模有个法则 （a+b) mod c = （a mod c + b mod c）mod c
         * 可以用阿贝尔群证明。
         */
        return;
    &#125;
    build(lson);/* 递归 lson和rson定义在宏里 */
    build(rson);
    /*
     * 线段树是一棵二叉树，
     * 可以想象、用纸推一下这个性质，
     * 左子树序号一定是父节点的两倍，右子树一定是父节点的两倍加1
     * （在这里因为左子树序号是个偶数，所以它的二进制末位一定是0，
     * 用|位操作符来|1其实就是加1，用位操作符比用+更快，是一个优化）
     */
    segment_tree[rt]=(segment_tree[rt&lt;&lt;1] + segment_tree[rt&lt;&lt;1|1])%mod;
&#125;

void query(int rt,int l,int r,int L,int R)
/* 查询函数 小写l、r 是查询范围，大写L、R是线段树的范围*/
&#123;
    if(L&lt;=l&amp;&amp;r&lt;=R) &#123; /* 如果在范围内 加上这个结点的值*/
        res+=segment_tree[rt];
        res%=mod;
        return;
    &#125;
    /* 
     * #define lson rt&lt;&lt;1,l,mid
     * #define rson rt&lt;&lt;1|1,mid+1,r 
    */
    else /* 如果是在跨范围的就分成两块递归，如果这个结点还有懒标记属性，就先打破懒标记 */
    &#123;
        if(lazy[rt])pushdown(rt,len);
        if(L&lt;=mid)query(lson,L,R);  
        if(R&gt;mid)query(rson,L,R);
    &#125;
&#125;

void update(int rt,int l,int r,int L,int R,int k)//1 1 5 0 
/* 区间更新函数  大至同理于区间查询函数*/
&#123;
    if(L&lt;=l&amp;&amp;r&lt;=R) &#123;
        lazy[rt]+=k;/* 这里就是应该用懒标记的地方 */
        segment_tree[rt]+=k*len; /* 乘以个数在pushdown函数中有解释 */
    &#125;
    else &#123;
        if(lazy[rt]) pushdown(rt,len);/* 如果有懒标记打破 */
        /* 跨区间就分开处理 */
        if(L&lt;=mid) update(lson,L,R,k);
        if(R&gt;mid) update(rson,L,R,k);
        segment_tree[rt]=(segment_tree[rt&lt;&lt;1]+segment_tree[rt&lt;&lt;1|1])%mod;
    &#125;
&#125;

/* END */

/* START execute part */
/*
 * 这一部分是针对操作1234的实际操作部分，
 * 3、4就是基本的线段树
 * 接下来着重讲1、2操作。
 * 
 */
int query_lca(int x,int y)&#123;
    int ans=0;
    while(array_top[x]!=array_top[y])&#123;//当两个点不在同一条链上 
        if(depth[array_top[x]]&lt;depth[array_top[y]])swap(x,y);//把x点改为所在链顶端的深度更深的那个点
        res=0;
        query(1,1,n,id[array_top[x]],id[x]);//ans加上x点到x所在链顶端 这一段区间的点权和
        ans+=res;
        ans%=mod;//按题意取模 
        x=father[array_top[x]];//把x跳到x所在链顶端的那个点的上面一个点
    &#125;
    //直到两个点处于一条链上
    if(depth[x]&gt;depth[y])swap(x,y);//把x点深度更深的那个点
    res=0;
    query(1,1,n,id[x],id[y]);//这时再加上此时两个点的区间和即可
    ans+=res;
    return ans%mod;
&#125;

void update_lca(int x,int y,int k)&#123;//同上 
    k%=mod;
    while(array_top[x]!=array_top[y])&#123;
        if(depth[array_top[x]]&lt;depth[array_top[y]])swap(x,y);
        update(1,1,n,id[array_top[x]],id[x],k);
        x=father[array_top[x]];
    &#125;
    if(depth[x]&gt;depth[y])swap(x,y);
    update(1,1,n,id[x],id[y],k);
&#125;

int query_segment_tree(int x)&#123;
    res=0;
    query(1,1,n,id[x],id[x]+node_size[x]-1);//子树区间右端点为id[x]+siz[x]-1 
    return res;
&#125;

void update_segment_tree(int x,int k)&#123;//同上 //4 2
    update(1,1,n,id[x],id[x]+node_size[x]-1,k); //1 1 5 0 0 2
&#125;

/* END */

/* START Heavy-light Decomposition part */

void hld_dfs1(int x, int fa, int deep)
/*
 * 这个dfs1用来进行重链剖分的第一次递归，
 * 找到重子结点，并把它的heavy son通过数组记录。
 * 接下来就可以进行dfs2把heavy son连成heavy_edge。
 */
&#123;
    depth[x] = deep;/* lca */
    father[x] = fa;/* 这里的father数组实际上是重链连接起来的关键，详见dfs2 */
    node_size[x] = 1;
    int heavy_son_size = -1;
    for(int i=head[x];i;i=e[i].next) &#123;
        int to = e[i].to;
        if(to == fa) continue;/*若为父亲则跳过*/
        hld_dfs1(to, x, deep+1);/*dfs它的儿子*/ 
        node_size[x] += node_size[to];/*把它的儿子size加到它身上,遍历完后就会得到它的size*/
        if(node_size[to] &gt; heavy_son_size) &#123;
            heavy_son[x]=to;
            heavy_son_size=node_size[to];
            /* tips:一个父亲只有一个heavy son，
             * 如果有两个大小一样的heavy son，
             * 那就任选一个，不会对结果造成影响。
             */
        &#125;
    &#125;
&#125;

void hld_dfs2(int x,int top)
/*
 * 这个dfs是用来把heavy son连成heavy_edge的。
 * 一个heavy_edge一般有1个属性————顶点
 * 我们会记录它，因为链的dfs序是连续的，所以跳的过程也遵循dfs序，
 * 所以在接下来的lca中我们可以通过顶点的父亲来跳链。
 */
&#123;
    /* 接下来这两步是在对原先的序号重编为dfs序
     *（因为这段在一个dfs中，所以dfs2_cnt的自增会保证它是一个dfs序）。
     * top就是我们说的链顶。 -&gt; https://oi-wiki.org/graph/hld/
     */
    id[x]=++dfs2_cnt;
    wt[dfs2_cnt]=value[x];
    array_top[x] = top;
    if(!heavy_son[x]) return;
    /* 没有heavy_son意味着这一条重链我们已经遍历到尾了 */
    /* 按先处理重儿子，再处理轻儿子的顺序递归处理 */
    hld_dfs2(heavy_son[x],top);/* 重儿子 */
    for(int i=head[x];i;i=e[i].next)/* 轻儿子 */
    &#123;
        int to = e[i].to;
        if(to==father[x]||to==heavy_son[x]) continue;
        hld_dfs2(to,to);
    &#125;
&#125;

/* END */

/* END function and class block */


/* START main block */

int main() &#123;
    //freopen(&quot;p3384.in&quot;, &quot;r&quot;, stdin);
    //freopen(&quot;p3384.out&quot;, &quot;w&quot;, stdout);
    ios::sync_with_stdio(false);
    /* n: num of node
     * m: num of the execution
     * r: root&#39;s serial number
     * p: the mod num
     */
    cin &gt;&gt; n &gt;&gt; m &gt;&gt; r &gt;&gt; mod;
    for(int i=1;i&lt;=n;i++)
        cin &gt;&gt; value[i];
    int a,b;
    for(int i=1;i&lt;n;i++) &#123;
        cin &gt;&gt; a &gt;&gt; b;
        add_edge(a,b);
        add_edge(b,a);
    &#125;
    hld_dfs1(r,0,1); // 2 0 1
    hld_dfs2(r,r);
    /* for exec 1,2 */
    build(1,1,n);
    /* for exec 3,4 */
    while(m--) &#123;
        int x,y,w,exec;
        cin &gt;&gt; exec;
        /* 对操作进行处理：
         * 一共有四个操作
         * 操作1：格式：1 x y z 表示将树从 x 到 y 结点最短路径上所有节点的值都加上 z。
         * 操作2：格式：2 x y 表示求树从 x 到 y 结点最短路径上所有节点的值之和。
         * 操作3：格式：3 x z 表示将以 x 为根节点的子树内所有节点值都加上 z。
         * 操作4：格式：4 x 表示求以 x 为根节点的子树内所有节点值之和
         */
        if(exec == 1)&#123;
            cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;
            update_lca(x,y,w);
        &#125;
        else if(exec == 2) &#123;
            cin &gt;&gt; x &gt;&gt; y;
            cout &lt;&lt; query_lca(x,y)&lt;&lt;endl;
        &#125;
        else if(exec == 3) &#123;
            cin &gt;&gt; x &gt;&gt; w;
            update_segment_tree(x,w);//4 2
        &#125;
        else if(exec == 4) &#123;
            cin &gt;&gt; x;
            cout &lt;&lt; query_segment_tree(x)&lt;&lt;endl;
        &#125;
    &#125;
    cin.get();
&#125;

/* END main block */
//(rt=1, l=1, r=5, L=0, R=-1, k=2)
//Breakpoint 1, update_segment_tree (x=4, k=2) at p3384.cpp:208
//208         update(1,1,n,id[x],id[x]+node_size[x]-1,k);
//(gdb) p id
//$1 = &#123;0, 0, 1, 0 &lt;repeats 100007 times&gt;&#125;
//(gdb) p node_size
//$2 = &#123;0, 0, 1, 0 &lt;repeats 100007 times&gt;&#125;
</code></pre>
<p> <a href="http://xchkoo.github.io/p3384_2021-04-05/">http://xchkoo.github.io/p3384_2021-04-05/</a> 本作品采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='https://link.hhtjim.com/163/1409311773.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='https://link.hhtjim.com/163/1417265541.mp3'></li>
                        
                    
                        
                            <li title='2' data-url='https://link.hhtjim.com/163/2064261972.mp3'></li>
                        
                    
                        
                            <li title='3' data-url='https://link.hhtjim.com/163/1428153831.mp3'></li>
                        
                    
                        
                            <li title='4' data-url='https://link.hhtjim.com/163/1460606296.mp3'></li>
                        
                    
                        
                            <li title='5' data-url='https://link.hhtjim.com/163/1371306566.mp3'></li>
                        
                    
                        
                            <li title='6' data-url='https://link.hhtjim.com/163/28573320.mp3'></li>
                        
                    
                        
                            <li title='7' data-url='https://link.hhtjim.com/163/441102354.mp3'></li>
                        
                    
                        
                            <li title='8' data-url='https://link.hhtjim.com/163/441102355.mp3'></li>
                        
                    
                        
                            <li title='9' data-url='https://link.hhtjim.com/163/441102356.mp3'></li>
                        
                    
                        
                            <li title='10' data-url='https://link.hhtjim.com/163/441102358.mp3'></li>
                        
                    
                        
                            <li title='11' data-url='https://link.hhtjim.com/163/441102359.mp3'></li>
                        
                    
                        
                            <li title='12' data-url='https://link.hhtjim.com/163/441102360.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='false'
        data-ci='7a61432ab10a4ea8f35f'
        data-cs='b2913eac810df502dde1418253f24e86badb4c79'
        data-r='Xchkoo.github.io'
        data-o='Xchkoo'
        data-a='Xchkoo'
        data-d='true'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%B2%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">讲解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%9F%E9%A2%98%E5%92%8C%E5%80%BC%E5%BE%97%E5%8F%82%E8%80%83%E7%9A%84%E5%8D%9A%E5%AE%A2"><span class="toc-number">2.</span> <span class="toc-text">原题和值得参考的博客</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">3.</span> <span class="toc-text">代码</span></a></li></ol>	
        </div>
    
</div>


    </div>
</div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"./live2d_models/haruna/33/model.2018.bls-winter.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-B9GY5PFRRK', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


</html>
